**LFI (Local File Inclusion)** ‚Äî –ª–æ–∫–∞–ª—å–Ω–æ–µ –≤–∫–ª—é—á–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤.

---

### **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç LFI**

–í URL –µ—Å—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä, –∫–æ—Ç–æ—Ä—ã–π —É–∫–∞–∑—ã–≤–∞–µ—Ç –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É:

```
http://natas7.natas.labs.overthewire.org/index.php?page=home
```

–í–Ω—É—Ç—Ä–∏ PHP-–∫–æ–¥–∞, —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —á—Ç–æ-—Ç–æ –≤—Ä–æ–¥–µ:

```php
<?php
$page = $_GET['page'];  // –ü–æ–ª—É—á–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä page –∏–∑ URL
include($page . ".php");  // –í–∫–ª—é—á–∞–µ—Ç —Ñ–∞–π–ª –∫–∞–∫ —á–∞—Å—Ç—å –∫–æ–¥–∞
?>
```

 **–ü—Ä–æ–±–ª–µ–º–∞:**  
–ü–∞—Ä–∞–º–µ—Ç—Ä `page` –Ω–µ —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç—Å—è –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç —É–∫–∞–∑—ã–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–µ –ø—É—Ç–∏. –≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ —Ç–æ–º—É, —á—Ç–æ –º–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Ñ–∞–π–ª—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä:

```
http://natas7.natas.labs.overthewire.org/index.php?page=/etc/natas_webpass/natas8
```

---

###  **–ö–∞–∫ —ç—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –∞—Ç–∞–∫–µ**

1. **–ß—Ç–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤:**  
    –ê—Ç–∞–∫—É—é—â–∏–π –º–æ–∂–µ—Ç —á–∏—Ç–∞—Ç—å –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã, —Ç–∞–∫–∏–µ –∫–∞–∫:
    
    - `/etc/passwd` ‚Äî —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ Unix/Linux.
        
    - `/etc/natas_webpass/natas8` ‚Äî –ø–∞—Ä–æ–ª—å –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —É—Ä–æ–≤–Ω—è.
        
2. **–ß—Ç–µ–Ω–∏–µ –ª–æ–≥–æ–≤ –∏ –∫—ç—à–∞:**  
    –í–æ–∑–º–æ–∂–Ω–æ –∏–∑–≤–ª–µ—á—å –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞ –∏ –ø–æ–ª—É—á–∏—Ç—å –ø–æ–ª–µ–∑–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.
    
3. **–ò–Ω–æ–≥–¥–∞ ‚Äî –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–¥–∞ (RCE):**  
    –í –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö LFI –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —É–¥–∞–ª–µ–Ω–Ω–æ–º—É –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é –∫–æ–¥–∞ (**Remote Code Execution ‚Äî RCE**), –µ—Å–ª–∏ —É–¥–∞–µ—Ç—Å—è –≤–∫–ª—é—á–∏—Ç—å —Ñ–∞–π–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –∞—Ç–∞–∫—É—é—â–∏–π –º–æ–∂–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ª–æ–≥–∏ —Å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–º –∫–æ–¥–æ–º).
    

---

### **–¢–∏–ø–∏—á–Ω—ã–µ –ø–æ–ª–µ–∑–Ω—ã–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –¥–ª—è LFI**

- `/etc/passwd`
    
- `/var/www/html/config.php` ‚Äî –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã.
    
- `php://filter/convert.base64-encode/resource=index.php` ‚Äî –æ–±–æ–π—Ç–∏ —Ñ–∏–ª—å—Ç—Ä—ã –∏ –ø–æ–ª—É—á–∏—Ç—å –∫–æ–¥ –≤ base64.
    

---

###  **–ö–∞–∫ –∑–∞—â–∏—Ç–∏—Ç—å—Å—è –æ—Ç LFI**

1. **–ü—Ä–æ–≤–µ—Ä—è—Ç—å –∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.**  
    –ò—Å–ø–æ–ª—å–∑—É–π –≤–∞–ª–∏–¥–∞—Ü–∏—é –∏ whitelisting:
    

```php
$allowed_pages = ['home', 'about', 'contact'];
if (in_array($_GET['page'], $allowed_pages)) {
    include($_GET['page'] . ".php");
} else {
    die("Access denied.");
}
```

2. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `basename()` –∏ `realpath()`** –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—É—Ç–µ–π:
    

```php
$page = basename($_GET['page']);
include("pages/" . $page . ".php");
```

3. **–û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Å–∏—Å—Ç–µ–º–Ω—ã–º —Ñ–∞–π–ª–∞–º.**  
    –ù–∞—Å—Ç—Ä–æ–∏—Ç—å `open_basedir` –≤ PHP, —á—Ç–æ–±—ã –∑–∞–ø—Ä–µ—Ç–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–º –ø–∞–ø–∫–∞–º.
    

---

###  **LFI vs. RFI (Remote File Inclusion)**

- **LFI** ‚Äî –≤–∫–ª—é—á–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã —Å —Å–µ—Ä–≤–µ—Ä–∞.
    
- **RFI** ‚Äî –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å —É–¥–∞–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –∏ –≤—ã–ø–æ–ª–Ω—è—Ç—å –∏—Ö –∫–∞–∫ –∫–æ–¥.
    

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ —Ä–∞–∑–æ–±—Ä–∞—Ç—å, –∫–∞–∫ –∏—Å–∫–∞—Ç—å LFI –∏–ª–∏ –∑–∞—â–∏—Ç–∏—Ç—å—Å—è ‚Äî –ø–∏—à–∏! üöÄ